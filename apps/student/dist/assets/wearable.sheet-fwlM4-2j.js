const q="1zwKrUcOJtajPdOu9QKmkYzNniIscTKMnNd4G5gudEhQ",U="WearableItem",j="https://unluckyidiot16.github.io/assets-common/QuizRpg/".replace(/\/+$/,"")||"",c=o=>{if(o==null||o==="")return;const t=Number(o);return Number.isFinite(t)?t:void 0},H=o=>{const t=String(o??"").trim().toLowerCase();return t==="true"||t==="1"||t==="y"||t==="yes"},K=new Set(["common","uncommon","rare","epic","legendary","mythic"]),L=o=>{const t=String(o??"").trim().toLowerCase();return K.has(t)?t:void 0},Q=(o,t)=>o?`${o}/${t.replace(/^\/+/,"")}`:t.replace(/^\/+/,"");function W(o){const t=o.indexOf("{"),a=o.lastIndexOf("}");if(t===-1||a===-1)throw new Error("gviz: invalid payload");return JSON.parse(o.slice(t,a+1))}function Y(o,t){const a=`https://docs.google.com/spreadsheets/d/${o}/gviz/tq`,f=encodeURIComponent("select *");return`${a}?tqx=out:json&sheet=${encodeURIComponent(t)}&tq=${f}`}async function _(){var o,t;try{const a=await fetch(Y(q,U),{cache:"no-store"});if(!a.ok)throw new Error(`gviz HTTP ${a.status}`);const f=await a.text(),m=W(f),z=(((o=m.table)==null?void 0:o.cols)||[]).map(r=>String((r==null?void 0:r.label)??"").trim().toLowerCase()),F=((t=m.table)==null?void 0:t.rows)||[],n=r=>z.indexOf(r),s={id:n("id"),name:n("name"),slot:n("slot"),path:n("path"),rarity:n("rarity"),opacity:n("opacity"),scale:n("scale"),offsetX:n("offsetx"),offsetY:n("offsety"),aCols:n("atlascols"),aRows:n("atlasrows"),aFrames:n("atlasframes"),aFps:n("atlasfps"),active:n("active")},p={};for(const r of F){const d=r.c||[],e=u=>{var R,$;return u>=0?((R=d[u])==null?void 0:R.v)??(($=d[u])==null?void 0:$.f)??"":""},i=String(e(s.id)??"").trim();if(!i)continue;const O=H(e(s.active));if(s.active>=0&&!O)continue;const T=String(e(s.name)??i).trim(),y=String(e(s.slot)??"").trim(),l=String(e(s.path)??"").trim();if(!y||!l)continue;const g=L(e(s.rarity)),h=c(e(s.opacity)),w=c(e(s.scale)),S=c(e(s.offsetX)),v=c(e(s.offsetY)),b=c(e(s.aCols)),x=c(e(s.aRows)),C=c(e(s.aFrames)),E=c(e(s.aFps)),I=/^https?:\/\//i.test(l)?l:Q(j,l),N={kind:"cosmetic",id:i,name:T,slot:y,src:I,...g?{rarity:g}:{},...h!=null?{opacity:h}:{},...w!=null?{scale:w}:{},...S!=null||v!=null?{offset:{x:S||0,y:v||0}}:{},...b&&x&&C?{atlas:{cols:b,rows:x,frames:C,...E?{fps:E}:{}}}:{}};p[i]=N}return p}catch{return{}}}const k=_;export{_ as loadWearablesCatalog,k as loadWearablesCatalogFromSheet};
